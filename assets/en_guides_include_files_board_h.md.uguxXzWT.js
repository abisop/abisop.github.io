import{_ as i,c as o,al as a,o as t}from"./chunks/framework.NFAqBSgQ.js";const p=JSON.parse('{"title":"Including Files in board.h","description":"","frontmatter":{},"headers":[],"relativePath":"en/guides/include_files_board_h.md","filePath":"en/guides/include_files_board_h.md"}'),r={name:"en/guides/include_files_board_h.md"};function d(c,e,l,s,h,n){return t(),o("div",null,e[0]||(e[0]=[a('<h1 id="including-files-in-board-h" tabindex="-1">Including Files in board.h <a class="header-anchor" href="#including-files-in-board-h" aria-label="Permalink to &quot;Including Files in board.h&quot;">​</a></h1><p>Warning</p><p>Migrated from: <a href="https://cwiki.apache.org/confluence/display/NUTTX/Including+Files+in+board.h" target="_blank" rel="noreferrer">https://cwiki.apache.org/confluence/display/NUTTX/Including+Files+in+board.h</a></p><h2 id="global-scope-of-board-h" tabindex="-1">Global Scope of board.h <a class="header-anchor" href="#global-scope-of-board-h" aria-label="Permalink to &quot;Global Scope of board.h&quot;">​</a></h2><p>Each board under the <code>boards/</code> directory must provide a header file call <code>board.h</code> in the board&#39;s <code>include/</code> sub-directory.</p><p>When the board is configured symbolic links will be created to the board&#39;s <code>board.h</code> header file at <code>include/arch/board/board.h</code>. Header files at that location have [Global Scope]{.title-ref} meaning they can be included by C/C++ logic anywhere in the system. For example, the <code>board.h</code> file can be included by any file with:</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>#include &lt;arch/board/board.h&gt;</span></span></code></pre></div><h2 id="restricted-scope-of-architecture-specific-header-files" tabindex="-1">Restricted Scope of Architecture-Specific Header Files <a class="header-anchor" href="#restricted-scope-of-architecture-specific-header-files" aria-label="Permalink to &quot;Restricted Scope of Architecture-Specific Header Files&quot;">​</a></h2><p>Each architecture also provides internal architecture-specific header files that can be included only by (1) the architecture logic itself and (2) by board logic based on that architecture. This is made possible by special include path options in the CFLAGS provided by the NuttX build system to the architecture and board logic [only]{.title-ref}.</p><p>For this reason, the scope of the architecture-specific header files is [restricted]{.title-ref}. Any attempt to include the architecture-specific header files by logic other than architecture- or board-specific logic will result in a compilation error. This is the intended behavior; it is implemented this way to prevent the use of such [restricted]{.title-ref}, non-portable files throughout the OS. Doing so would degrade the modularity of the OS and would take many giant steps down the path toward [spaghetti code]{.title-ref}.</p><h2 id="errors-due-to-mixed-scope-of-header-files" tabindex="-1">Errors due to Mixed Scope of Header Files <a class="header-anchor" href="#errors-due-to-mixed-scope-of-header-files" aria-label="Permalink to &quot;Errors due to Mixed Scope of Header Files&quot;">​</a></h2><p>The <code>board.h</code> header file is included in many contexts including both by the architecture- and board-specific logic but also by other common OS logic. As examples:</p><ul><li>Architecture-specific code may include the <code>board.h</code> header file to get GPIO pin definitions or to get configuration information to configure processor clocking.</li><li>Common LED and button drivers include board&#39;s <code>board.h</code> header file to get LED and button definitions, respectively.</li><li>Applications may include the <code>board.h</code> header file to get, for example, <code>boardctl()</code> board-specific IOCTL commands.</li></ul><p>In the first example, the <code>board.h</code> header file often uses pre-processor symbols that require definition from an architecture-specific header file. For example, GPIO pin definitions or clock configuration register settings. However, [you must avoid the temptation to include any of those architecture-specific header files in the board.h header file. This is prohibited!]{.title-ref} That would be a &quot;time bomb&quot; waiting to cause a compilation failure in the future.</p><h2 id="so-how-do-i-avoid-this" tabindex="-1">So How Do I Avoid This? <a class="header-anchor" href="#so-how-do-i-avoid-this" aria-label="Permalink to &quot;So How Do I Avoid This?&quot;">​</a></h2><p>The only way to avoid this header file inclusion trap is:</p><ul><li>Never include architecture-specific header files in the <code>board.h</code> header file. Instead,</li><li>Include the header files needed by the the <code>board.h</code> header file in the C file that includes <code>board.h</code></li><li>Make sure that <code>board.h</code> is the last header file included.</li></ul>',17)]))}const f=i(r,[["render",d]]);export{p as __pageData,f as default};
